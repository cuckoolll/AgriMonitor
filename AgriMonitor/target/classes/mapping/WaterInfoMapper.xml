<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.agri.monitor.mapper.WaterInfoMapper">
    <select id="findAll" resultType="com.agri.monitor.entity.WaterInfo">
        SELECT * FROM T_WATER_QUALITY
    </select>
    
    <select id="queryInfoByCountryAndTime" resultType="com.agri.monitor.entity.WaterInfo">
        SELECT GID,
			   QUALITY_ADDRESS,
			   COUNTY,
			   QUALITY_TIME,
			   QUALITY_TYPE,
			   QUALITY_RESULT,
			   REMARKS
          FROM T_WATER_QUALITY 
    	<if test="county != null and county != ''">
        	WHERE COUNTY = #{county} 
        </if>
        <if test="county == null or county == ''">
        	<if test="time != null and time != ''">
        		WHERE QUALITY_TIME = #{time}
        	</if>
        </if>
        <if test="time != null and time != ''">
        	AND QUALITY_TIME = #{time}
       	</if>
       	 ORDER BY QUALITY_TIME DESC
    </select>
    
    <insert id="insertWaterInfo" parameterType="com.agri.monitor.entity.WaterInfo">
    	INSERT INTO T_WATER_QUALITY
    		(QUALITY_ADDRESS,
			 COUNTY,
			 QUALITY_TIME,
			 QUALITY_TYPE,
			 QUALITY_RESULT,
			 REMARKS,
			 CREATE_TIME,
			 CREATOR,
			 MODIFIER)
    	VALUES
		   (#{quality_address},
			#{county},
			#{quality_time},
			#{quality_type},
			#{quality_result},
			#{remarks},
			#{create_time},
			#{creator},
			#{modifier})
    </insert>
    
    <update id="updateWaterInfo" parameterType="com.agri.monitor.entity.WaterInfo">
    	UPDATE T_WATER_QUALITY
    	   SET QUALITY_RESULT = #{quality_result},
    	   	   REMARKS = #{remarks},
    	   	   MODIFIER = #{modifier}
    	 WHERE GID = #{gid}
    </update>
    
    <select id="queryGid" resultType="java.lang.String">
   		SELECT GID
     	  FROM T_WATER_QUALITY
     	 WHERE COUNTY = #{county}
     	   AND QUALITY_TIME = #{time}
     	   AND QUALITY_TYPE = #{type}
     </select>
</mapper>